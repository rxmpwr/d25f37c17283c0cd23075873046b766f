# localize_to_vietnamese.py - Complete Vietnamese Localization System

"""
Vietnamese Localization System for YouTube Analyzer Pro
Provides comprehensive translation for all UI elements and messages
"""

# =============================================================================
# VIETNAMESE TRANSLATIONS DICTIONARY
# =============================================================================

VIETNAMESE_TRANSLATIONS = {
    # =========================
    # MAIN WINDOW & NAVIGATION
    # =========================
    "Viral YouTube Analyzer Pro": "Viral Youtube Content Creator ",
    "Analyze YouTube content → Customize prompts → Generate viral stories": 
        "Analyze YouTube content → Customize prompts → Generate viral stories)",
    "Performance mode: Active": "Performance mode: Active",
    
    # Navigation Tabs
    "Input Configuration": "Cấu Hình Đầu Vào",
    "Analysis Result": "Kết Quả Phân Tích", 
    "Create Prompts": "Tạo Prompts",
    "Generate Topic": "Tạo Chủ Đề",
    "Generate Content": "Tạo Nội Dung",
    "Settings": "Cài Đặt",
    "Performance": "Hiệu Suất",
    
    # =========================
    # INPUT TAB
    # =========================
    "Nhập URL Youtube": "Nhập URL Youtube",
    "Analysis mode:": "Chế độ phân tích:",
    "Channel analysis": "Phân tích kênh",
    "Video list analysis": "Phân tích danh sách video",
    "Enter YouTube video URLs:": "Nhập URL video Youtube:",
    "Additional Analysis Requirements (Optional):": "Yêu Cầu Phân Tích Bổ Sung:",
    "Describe specific insights you want from analysis. Leave blank for automatic analysis.": 
        "Mô tả những insights cụ thể bạn muốn từ phân tích. Để trống cho phân tích tự động.",
    "Leave blank for automatic analysis or describe specific requirements...": 
        "Để trống cho phân tích tự động hoặc mô tả yêu cầu cụ thể...",
    "Quick templates:": "Mẫu nhanh:",
    "Clear All URLs": "Xóa Tất Cả URLs",
    "Check URLs": "Kiểm Tra URLs", 
    "Load Sample URLs": "Tải URLs Mẫu",
    "Max videos (per channel):": "Số video tối đa (mỗi kênh):",
    "Max comments (per video):": "Số bình luận tối đa (mỗi video):",
    "Include subtitles": "Bao gồm phụ đề",
    "Include comments": "Bao gồm bình luận",
    "Analyze": "Phân Tích",
    
    # Template Categories
    "Viral Analysis": "Phân Tích Viral",
    "Audience Insights": "Insights Khán Giả", 
    "Content Strategy": "Chiến Lược Nội Dung",
    "Competitor Analysis": "Phân Tích Đối Thủ",
    
    # =========================
    # ANALYSIS RESULTS
    # =========================
    "Analysis Results": "Kết Quả Phân Tích",
    "Real-time analysis of YouTube content with viral insights (Performance Optimized)": 
        "Phân tích thời gian thực nội dung Youtube với insights viral",
    
    # Progress Section
    "Analyzing YouTube Data...": "Đang Phân Tích Dữ Liệu Youtube...",
    "Processing YouTube videos, comments, transcripts and generating AI insights...": 
        "Đang xử lý video Youtube, bình luận, phụ đề và tạo AI insights...",
    "Time elapsed:": "Thời gian đã qua:",
    "Videos analyzed:": "Video đã phân tích:",
    "Comments collected:": "Bình luận đã thu thập:",
    "Transcripts extracted:": "Phụ đề đã trích xuất:",
    "Current task:": "Tác vụ hiện tại:",
    "Initializing...": "Đang khởi tạo...",
    
    # Success Header
    "Analysis Complete!": "Phân Tích Hoàn Tất!",
    "Viral Score:": "Điểm Viral:",
    "High Viral Potential!": "Tiềm Năng Viral Cao!",
    "Good Growth Potential": "Tiềm Năng Tăng Trưởng Tốt",
    "Improvement Opportunities": "Cơ Hội Cải Thiện",
    
    # Executive Summary
    "EXECUTIVE SUMMARY": "TÓM TẮT ĐIỀU HÀNH",
    "Channels Analyzed:": "Kênh Đã Phân Tích:",
    "Total Videos:": "Tổng Số Video:",
    "Total Views:": "Tổng Lượt Xem:",
    "Total Likes:": "Tổng Lượt Thích:",
    "Comments Collected:": "Bình Luận Đã Thu Thập:",
    "Transcripts Extracted:": "Phụ Đề Đã Trích Xuất:",
    "Avg Views/Video:": "Trung Bình Lượt Xem/Video:",
    "Avg Engagement Rate:": "Tỷ Lệ Tương Tác Trung Bình:",
    
    # Performance Metrics
    "KEY PERFORMANCE METRICS": "CHỈ SỐ HIỆU SUẤT CHÍNH",
    "No video data available for metrics calculation": "Không có dữ liệu video để tính toán chỉ số",
    "Performance Distribution": "Phân Phối Hiệu Suất",
    "Highest Views": "Lượt Xem Cao Nhất",
    "Median Views": "Lượt Xem Trung Vị",
    "Lowest Views": "Lượt Xem Thấp Nhất",
    "Engagement Analysis": "Phân Tích Tương Tác",
    "Average Engagement": "Tương Tác Trung Bình",
    "Peak Engagement": "Tương Tác Đỉnh",
    "High Performers": "Video Hiệu Suất Cao",
    "Viral Candidates": "Ứng Viên Viral",
    "videos": "video",
    
    # Top Content
    "TOP PERFORMING CONTENT": "NỘI DUNG HIỆU SUẤT CAO NHẤT",
    "views": "lượt xem",
    "likes": "lượt thích", 
    "comments": "bình luận",
    "engagement": "tương tác",
    
    # Audience Insights
    "AUDIENCE INSIGHTS": "INSIGHTS KHÁN GIẢ",
    "No comments available for audience analysis": "Không có bình luận để phân tích khán giả",
    "Sentiment Analysis": "Phân Tích Cảm Xúc",
    "Positive Comments": "Bình Luận Tích Cực",
    "Negative Comments": "Bình Luận Tiêu Cực",
    "Top Comments by Engagement": "Bình Luận Hàng Đầu Theo Tương Tác",
    
    # Content Analysis
    "CONTENT ANALYSIS": "PHÂN TÍCH NỘI DUNG",
    "No content data available for analysis": "Không có dữ liệu nội dung để phân tích",
    "Duration Analysis": "Phân Tích Thời Lượng",
    "Average Duration": "Thời Lượng Trung Bình",
    "Total Videos with Duration": "Tổng Video Có Thời Lượng",
    "Language & Transcript Analysis": "Phân Tích Ngôn Ngữ & Phụ Đề",
    "Videos with Transcripts": "Video Có Phụ Đề",
    "Total Words Analyzed": "Tổng Từ Đã Phân Tích",
    "minutes": "phút",
    
    # AI Insights
    "AI INSIGHTS & ANALYSIS": "AI INSIGHTS & PHÂN TÍCH",
    
    # Viral Analysis
    "VIRAL POTENTIAL ANALYSIS": "PHÂN TÍCH TIỀM NĂNG VIRAL",
    "Overall Viral Score": "Điểm Viral Tổng Thể",
    "Score Breakdown": "Phân Tích Điểm Số",
    "Content Quality": "Chất Lượng Nội Dung",
    "Engagement Rate": "Tỷ Lệ Tương Tác",
    "Growth Potential": "Tiềm Năng Tăng Trưởng",
    "Audience Appeal": "Sức Hấp Dẫn Khán Giả",
    
    # Strengths & Opportunities
    "STRENGTHS & OPPORTUNITIES": "ĐIỂM MẠNH & CƠ HỘI",
    "STRENGTHS": "ĐIỂM MẠNH",
    "OPPORTUNITIES": "CƠ HỘI",
    
    # Common Strengths
    "High viral potential content": "Nội dung có tiềm năng viral cao",
    "Strong view performance": "Hiệu suất lượt xem mạnh",
    "Good audience engagement": "Tương tác khán giả tốt",
    "Active community interaction": "Tương tác cộng đồng tích cực",
    "Consistent content creation": "Tạo nội dung nhất quán",
    "Positive audience sentiment": "Cảm xúc khán giả tích cực",
    "Building content foundation": "Xây dựng nền tảng nội dung",
    "Gathering audience insights": "Thu thập insights khán giả",
    "Learning platform dynamics": "Học động lực nền tảng",
    
    # Common Opportunities
    "Improve content viral potential": "Cải thiện tiềm năng viral nội dung",
    "Increase audience engagement": "Tăng tương tác khán giả",
    "Optimize for higher reach": "Tối ưu để tăng độ phủ",
    "Build stronger community": "Xây dựng cộng đồng mạnh hơn",
    "Expand content variety": "Mở rộng đa dạng nội dung",
    "Optimize posting schedule": "Tối ưu lịch đăng bài",
    "Improve thumbnails and titles": "Cải thiện thumbnail và tiêu đề",
    
    # Recommendations
    "ACTIONABLE RECOMMENDATIONS": "KHUYẾN NGHỊ CÓ THỂ THỰC HIỆN",
    "Content Optimization": "Tối Ưu Nội Dung",
    "Audience Engagement": "Tương Tác Khán Giả", 
    "Growth Strategy": "Chiến Lược Tăng Trưởng",
    
    # Detailed Breakdown
    "DETAILED VIDEO BREAKDOWN": "PHÂN TÍCH CHI TIẾT VIDEO",
    "No videos available for detailed breakdown": "Không có video để phân tích chi tiết",
    "Showing top": "Hiển thị top",
    "of": "trên",
    "videos (Performance Optimized)": "video (Tối ưu hiệu suất)",
    "more videos available in saved analysis file": "video khác có trong file phân tích đã lưu",
    
    # Additional Requirements
    "Additional Analysis Requirements": "Yêu Cầu Phân Tích Bổ Sung",
    "Add specific requirements for AI analysis or custom insights you need:": 
        "Thêm yêu cầu cụ thể cho phân tích AI hoặc insights tùy chỉnh bạn cần:",
    "Enter additional requirements for AI analysis...": "Nhập yêu cầu bổ sung cho phân tích AI...",
    
    # Action Buttons
    "Load Previous Results": "Tải Kết Quả Cũ",
    "Create AI Prompts": "Tạo AI Prompts",
    "Export JSON": "Xuất JSON",
    "Export CSV": "Xuất CSV",
    
    # Auto-save notifications
    "Results automatically saved to:": "Kết quả đã tự động lưu vào:",
    
    # =========================
    # DIALOG MESSAGES
    # =========================
    "No URLs": "Không có URLs",
    "Please enter at least one YouTube URL.": "Vui lòng nhập ít nhất một URL YouTube.",
    "Invalid URLs found": "Tìm thấy URLs không hợp lệ",
    "found invalid URLs. Continue with valid URLs?": "URLs không hợp lệ được tìm thấy. Tiếp tục với URLs hợp lệ?",
    "No valid URLs": "Không có URLs hợp lệ", 
    "No valid YouTube URLs found.": "Không tìm thấy URLs YouTube hợp lệ.",
    "Invalid parameters": "Tham số không hợp lệ",
    "Max videos and comments must be numbers.": "Số video và bình luận tối đa phải là số.",
    "Validation Result": "Kết Quả Kiểm Tra",
    "All": "Tất cả",
    "URLs are valid!": "URLs đều hợp lệ!",
    "Invalid URLs:": "URLs không hợp lệ:",
    "and": "và",
    "more": "nữa",
    
    # Load Previous Results Dialog
    "Select Previous Analysis Results": "Chọn Kết Quả Phân Tích Cũ",
    "Choose an analysis result to view:": "Chọn một kết quả phân tích để xem:",
    "Analysis from": "Phân tích từ",
    "Cancel": "Hủy",
    "Load Selected": "Tải Đã Chọn",
    "No Selection": "Không Có Lựa Chọn",
    "Please select a file to load.": "Vui lòng chọn file để tải.",
    "Success": "Thành Công",
    "Successfully loaded analysis results from:": "Đã tải thành công kết quả phân tích từ:",
    "Error": "Lỗi",
    "Failed to load analysis file:": "Không thể tải file phân tích:",
    "No Previous Results": "Không Có Kết Quả Cũ",
    "No previous analysis results found.": "Không tìm thấy kết quả phân tích cũ.",
    "Run an analysis first to save results.": "Chạy phân tích trước để lưu kết quả.",
    "Failed to load previous results:": "Không thể tải kết quả cũ:",
    
    # =========================
    # SETTINGS TAB
    # =========================
    "API Configuration": "Cấu Hình API",
    "YouTube API Keys": "Youtube API Keys",
    "OpenAI API Keys": "OpenAI API Keys", 
    "Add API Key": "Thêm API Key",
    "Remove Selected": "Xóa Đã Chọn",
    "Test Connection": "Test Kết Nối",
    "Save Settings": "Lưu Cài Đặt",
    "Generation Settings": "Cài Đặt Tạo",
    "Viral Threshold": "Ngưỡng Viral",
    "Quality": "Chất Lượng",
    "Enable Viral Scoring": "Bật Tính Điểm Viral",
    "Enable Retry": "Bật Thử Lại",
    "Auto Optimize": "Tự Động Tối Ưu",
    
    # =========================
    # ERROR MESSAGES
    # =========================
    "API Keys Required": "Cần API Keys",
    "Please configure your API keys in the Settings tab.": "Vui lòng cấu hình API keys trong tab Cài Đặt.",
    "Missing Dependencies": "Thiếu Dependencies",
    "YouTube integration module not available!": "Module tích hợp Youtube không có!",
    "Please install required packages:": "Vui lòng cài đặt các package cần thiết:",
    "No YouTube API Keys": "Không Có Youtube API Keys",
    "Please add at least one Youtube API key in Settings tab.": "Vui lòng thêm ít nhất một Youtube API key trong tab Cài Đặt.",
    "Analysis Error": "Lỗi Phân Tích",
    "Failed to start analysis:": "Không thể bắt đầu phân tích:",
    "Startup Error": "Lỗi Khởi Động",
    "Failed to start YouTube Analyzer Pro:": "Không thể khởi động Viral Youtube Content Creator:",
    
    # =========================
    # PROGRESS MESSAGES
    # =========================
    "Initializing...": "Đang khởi tạo...",
    "Collecting channel data...": "Đang thu thập dữ liệu kênh...",
    "Collecting video data...": "Đang thu thập dữ liệu video...",
    "Processing video": "Đang xử lý video",
    "Analyzing with AI...": "Đang phân tích với AI...",
    "Complete!": "Hoàn tất!",
    
    # =========================
    # COMMON WORDS & PHRASES
    # =========================
    "Loading...": "Đang tải...",
    "Please wait...": "Vui lòng đợi...",
    "Processing...": "Đang xử lý...",
    "Saving...": "Đang lưu...",
    "Done": "Xong",
    "Close": "Đóng",
    "OK": "OK",
    "Yes": "Có",
    "No": "Không",
    "Save": "Lưu",
    "Load": "Tải",
    "Delete": "Xóa",
    "Edit": "Sửa",
    "Add": "Thêm",
    "Remove": "Xóa",
    "Clear": "Xóa",
    "Reset": "Đặt lại",
    "Apply": "Áp dụng",
    "Configure": "Cấu hình",
    "Settings": "Cài đặt",
    "Options": "Tùy chọn",
    "Help": "Trợ giúp",
    "About": "Giới thiệu",
    "Exit": "Thoát",
    "Back": "Quay lại",
    "Next": "Tiếp theo",
    "Previous": "Trước",
    "Continue": "Tiếp tục",
    "Finish": "Hoàn thành",
    "Start": "Bắt đầu",
    "Stop": "Dừng",
    "Pause": "Tạm dừng",
    "Resume": "Tiếp tục",
    "Retry": "Thử lại",
    "Skip": "Bỏ qua",
    "Warning": "Cảnh báo",
    "Information": "Thông tin",
    "Question": "Câu hỏi",
    "Confirmation": "Xác nhận",
    "File": "File",
    "Folder": "Thư mục",
    "Path": "Đường dẫn",
    "Name": "Tên",
    "Type": "Loại",
    "Size": "Kích thước",
    "Date": "Ngày",
    "Time": "Thời gian",
    "Status": "Trạng thái",
    "Progress": "Tiến độ",
    "Results": "Kết quả",
    "Data": "Dữ liệu",
    "Analysis": "Phân tích",
    "Report": "Báo cáo",
    "Summary": "Tóm tắt",
    "Details": "Chi tiết",
    "Overview": "Tổng quan",
    "Statistics": "Thống kê",
    "Metrics": "Chỉ số",
    "Performance": "Hiệu suất",
    "Quality": "Chất lượng",
    "Score": "Điểm",
    "Rating": "Đánh giá",
    "Rank": "Xếp hạng",
    "Position": "Vị trí",
    "Level": "Mức độ",
    "Category": "Danh mục",
    "Type": "Loại",
    "Format": "Định dạng",
    "Version": "Phiên bản",
    "Update": "Cập nhật",
    "Upgrade": "Nâng cấp",
    "Download": "Tải xuống",
    "Upload": "Tải lên",
    "Import": "Nhập",
    "Export": "Xuất",
    "Backup": "Sao lưu",
    "Restore": "Khôi phục",
    "Copy": "Sao chép",
    "Paste": "Dán",
    "Cut": "Cắt",
    "Undo": "Hoàn tác",
    "Redo": "Làm lại",
    "Search": "Tìm kiếm",
    "Filter": "Lọc",
    "Sort": "Sắp xếp",
    "Group": "Nhóm",
    "Select": "Chọn",
    "Deselect": "Bỏ chọn",
    "Check": "Kiểm tra",
    "Uncheck": "Bỏ kiểm tra",
    "Enable": "Bật",
    "Disable": "Tắt",
    "Show": "Hiển thị",
    "Hide": "Ẩn",
    "Open": "Mở",
    "View": "Xem",
    "Preview": "Xem trước",
    "Print": "In",
    "Share": "Chia sẻ",
    "Send": "Gửi",
    "Receive": "Nhận",
    "Connect": "Kết nối",
    "Disconnect": "Ngắt kết nối",
    "Online": "Trực tuyến",
    "Offline": "Ngoại tuyến",
    "Available": "Có sẵn",
    "Unavailable": "Không có sẵn",
    "Active": "Hoạt động",
    "Inactive": "Không hoạt động",
    "Enabled": "Đã bật",
    "Disabled": "Đã tắt",
    "Running": "Đang chạy",
    "Stopped": "Đã dừng",
    "Completed": "Đã hoàn thành",
    "Failed": "Thất bại",
    "Pending": "Đang chờ",
    "Ready": "Sẵn sàng",
    "Busy": "Bận",
    "Empty": "Trống",
    "Full": "Đầy",
    "Available": "Có sẵn",
    "Used": "Đã sử dụng",
    "Free": "Miễn phí",
    "Paid": "Trả phí",
    "Trial": "Dùng thử",
    "Premium": "Cao cấp",
    "Basic": "Cơ bản",
    "Advanced": "Nâng cao",
    "Professional": "Chuyên nghiệp",
    "Enterprise": "Doanh nghiệp",
    "Personal": "Cá nhân",
    "Business": "Kinh doanh",
    "Education": "Giáo dục",
    "Government": "Chính phủ",
    "Nonprofit": "Phi lợi nhuận",
}

# =============================================================================
# LOCALIZATION FUNCTIONS
# =============================================================================

def get_text(key: str, default: str = None) -> str:
    """
    Get Vietnamese translation for a given key.
    
    Args:
        key: The English text key to translate
        default: Default text if translation not found (uses key if None)
    
    Returns:
        Vietnamese translation or default/key if not found
    """
    if default is None:
        default = key
    
    return VIETNAMESE_TRANSLATIONS.get(key, default)

def translate_text(text: str) -> str:
    """
    Translate English text to Vietnamese.
    
    Args:
        text: English text to translate
    
    Returns:
        Vietnamese translation or original text if not found
    """
    return VIETNAMESE_TRANSLATIONS.get(text, text)

def format_number(number: int) -> str:
    """
    Format number with Vietnamese locale.
    
    Args:
        number: Number to format
    
    Returns:
        Formatted number string
    """
    return f"{number:,}".replace(",", ".")

def format_percentage(value: float, decimals: int = 1) -> str:
    """
    Format percentage with Vietnamese locale.
    
    Args:
        value: Percentage value
        decimals: Number of decimal places
    
    Returns:
        Formatted percentage string
    """
    return f"{value:.{decimals}f}%"

def format_duration(seconds: int) -> str:
    """
    Format duration in Vietnamese.
    
    Args:
        seconds: Duration in seconds
    
    Returns:
        Formatted duration string
    """
    minutes = seconds // 60
    seconds = seconds % 60
    
    if minutes == 0:
        return f"{seconds} giây"
    elif seconds == 0:
        return f"{minutes} phút"
    else:
        return f"{minutes} phút {seconds} giây"

def format_file_size(bytes_size: int) -> str:
    """
    Format file size in Vietnamese.
    
    Args:
        bytes_size: Size in bytes
    
    Returns:
        Formatted file size string
    """
    if bytes_size < 1024:
        return f"{bytes_size} B"
    elif bytes_size < 1024 * 1024:
        return f"{bytes_size / 1024:.1f} KB"
    elif bytes_size < 1024 * 1024 * 1024:
        return f"{bytes_size / (1024 * 1024):.1f} MB"
    else:
        return f"{bytes_size / (1024 * 1024 * 1024):.1f} GB"

def format_date_vietnamese(date_str: str) -> str:
    """
    Format date string in Vietnamese format.
    
    Args:
        date_str: ISO date string
    
    Returns:
        Vietnamese formatted date
    """
    try:
        from datetime import datetime
        
        # Parse ISO date
        dt = datetime.fromisoformat(date_str.replace('Z', '+00:00'))
        
        # Format in Vietnamese style
        return dt.strftime("%d/%m/%Y %H:%M:%S")
    except:
        return date_str

# =============================================================================
# BATCH TRANSLATION FUNCTIONS
# =============================================================================

def translate_dict(data: dict) -> dict:
    """
    Recursively translate dictionary values.
    
    Args:
        data: Dictionary to translate
    
    Returns:
        Dictionary with translated values
    """
    if isinstance(data, dict):
        return {key: translate_dict(value) for key, value in data.items()}
    elif isinstance(data, list):
        return [translate_dict(item) for item in data]
    elif isinstance(data, str):
        return translate_text(data)
    else:
        return data

def localize_ui_text(widget, text_attr='text'):
    """
    Localize text for a UI widget.
    
    Args:
        widget: UI widget to localize
        text_attr: Text attribute name (default: 'text')
    """
    try:
        current_text = getattr(widget, text_attr, '')
        if current_text:
            translated_text = translate_text(current_text)
            if hasattr(widget, 'configure'):
                widget.configure(**{text_attr: translated_text})
            else:
                setattr(widget, text_attr, translated_text)
    except Exception as e:
        print(f"Error localizing widget text: {e}")

# =============================================================================
# BATCH FILE PROCESSING
# =============================================================================

def get_files_to_localize():
    """
    Get list of Python files that need Vietnamese localization.
    
    Returns:
        List of file paths to localize
    """
    return [
        # Main application files
        "main.py",
        "app/main_window.py",
        
        # Tab files
        "app/tabs/input_tab.py",
        "app/tabs/analysis_tab.py",
        "app/tabs/content_tab.py", 
        "app/tabs/topic_tab.py",
        "app/tabs/settings_tab.py",
        "app/tabs/prompt_tab.py",
        "app/tabs/prompt_tab_simple.py",
        
        # Prompt related files
        "app/tabs/prompt/prompt_ai_analyzer.py",
        "app/tabs/prompt/prompt_dialogs.py",
        "app/tabs/prompt/prompt_export_manager.py",
        "app/tabs/prompt/prompt_generator_ui.py",
        "app/tabs/prompt/prompt_results_panel.py",
        "app/tabs/prompt/prompt_settings_panel.py",
        "app/tabs/prompt/prompt_tab_base.py",
        
        # Core modules
        "modules/youtube_collector.py",
        "modules/youtube_integration.py",
        
        # Utility files
        "utils/data_analyzers.py",
        "utils/data_exporters.py",
        "utils/data_formatters.py", 
        "utils/data_validators.py",
        "utils/ui_animations.py",
        "utils/ui_components.py",
        "utils/ui_styles.py",
        "utils/auto_save_manager.py",
        "utils/memory_manager.py",
        "utils/performance_dashboard.py",
        
        # Other important files
        "create_prompts.py",
        "analysis_results.py",
        "performance_config.py",
        "performance_optimizations.py",
    ]

def apply_localization_to_file(file_path: str):
    """
    Apply Vietnamese localization to a specific file.
    
    Args:
        file_path: Path to the file to localize
    """
    try:
        # Read file content
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # Apply translations
        translated_content = content
        for english, vietnamese in VIETNAMESE_TRANSLATIONS.items():
            # Only replace if it's a UI string (in quotes)
            patterns = [
                f'"{english}"',
                f"'{english}'",
                f'text="{english}"',
                f"text='{english}'",
                f'title="{english}"',
                f"title='{english}'",
            ]
            
            for pattern in patterns:
                vietnamese_pattern = pattern.replace(english, vietnamese)
                translated_content = translated_content.replace(pattern, vietnamese_pattern)
        
        # Write back translated content
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(translated_content)
        
        print(f"✅ Localized: {file_path}")
        
    except Exception as e:
        print(f"❌ Error localizing {file_path}: {e}")

def apply_full_localization():
    """
    Apply Vietnamese localization to all specified files.
    """
    print("🌍 Starting Vietnamese localization process...")
    print("="*60)
    
    files_to_localize = get_files_to_localize()
    success_count = 0
    error_count = 0
    
    for file_path in files_to_localize:
        try:
            apply_localization_to_file(file_path)
            success_count += 1
        except Exception as e:
            print(f"❌ Failed to localize {file_path}: {e}")
            error_count += 1
    
    print("="*60)
    print(f"🎯 Localization complete!")
    print(f"✅ Successfully localized: {success_count} files")
    print(f"❌ Failed to localize: {error_count} files")
    print(f"📊 Total translation keys: {len(VIETNAMESE_TRANSLATIONS)}")

# =============================================================================
# MAIN EXECUTION
# =============================================================================

if __name__ == "__main__":
    import sys
    
    if len(sys.argv) > 1:
        if sys.argv[1] == "--apply-all":
            apply_full_localization()
        elif sys.argv[1] == "--file":
            if len(sys.argv) > 2:
                apply_localization_to_file(sys.argv[2])
            else:
                print("Please specify a file path")
        elif sys.argv[1] == "--test":
            # Test translations
            test_keys = [
                "Analysis Results",
                "Viral Score:",
                "EXECUTIVE SUMMARY",
                "TOP PERFORMING CONTENT"
            ]
            
            print("🧪 Testing translations:")
            for key in test_keys:
                translation = get_text(key)
                print(f"'{key}' → '{translation}'")
        else:
            print("Unknown command. Use --apply-all, --file <path>, or --test")
    else:
        print("Vietnamese Localization System")
        print("Usage:")
        print("  python localize_to_vietnamese.py --apply-all    # Localize all files")
        print("  python localize_to_vietnamese.py --file <path>  # Localize specific file")
        print("  python localize_to_vietnamese.py --test         # Test translations")